{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"RubikREST","text":"<p>RubikREST is a powerful library designed to create instant RESTful interfaces by connecting Rubik ORM to the Erlenmeyer framework.</p> <p>With just a few lines of code, you can expose your Models as full-featured API endpoints with support for advanced filtering, pagination, sorting, and automatic Swagger documentation.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>\ud83d\ude80 Automatic CRUD: Generates GET, POST, PATCH, and DELETE routes.</li> <li>\ud83d\udd0d Advanced Filters: Supports operators such as <code>eq</code>, <code>gt</code>, <code>like</code>, <code>in</code>, etc., via URL parameters.</li> <li>\ud83d\udcc4 Pagination and Sorting: Natively integrated.</li> <li>\u26a1 Eager Loading: Load relationships using the <code>?with=</code> parameter.</li> <li>\ud83d\udee1\ufe0f Security: Protection against Mass Assignment via <code>$fillable</code> and middleware support.</li> <li>\ud83d\udcd1 Swagger UI: Automatic generation of OpenAPI documentation.</li> <li>\ud83c\udf10 JS Client: Includes a lightweight JavaScript client for API consumption.</li> </ul>"},{"location":"#links","title":"Links","text":"<ul> <li>GitHub</li> <li>Packagist</li> </ul>"},{"location":"advanced/cookbook/","title":"Cookbook &amp; Recipes","text":"<p>This guide contains solutions to common problems and advanced configurations when using RubikREST.</p>"},{"location":"advanced/cookbook/#creating-a-read-only-api","title":"Creating a Read-Only API","text":"<p>Sometimes you want to expose data without allowing modifications. Instead of creating manual routes or complex middlewares, you can simply use the granular middleware configuration to block write operations.</p> <p>If you don't provide a middleware that explicitly blocks access, RubikREST routes exist by default. To effectively make an API read-only, you can use a middleware that always returns 405 (Method Not Allowed) for write operations, or simply rely on your authentication middleware to deny access.</p> <p>However, the cleanest way to conceptually \"disable\" write routes is to guard them with a middleware that rejects everything.</p>"},{"location":"advanced/cookbook/#1-the-blocker-middleware","title":"1. The Blocker Middleware","text":"<pre><code>namespace App\\Middlewares;\n\nuse AdaiasMagdiel\\Erlenmeyer\\Request;\nuse AdaiasMagdiel\\Erlenmeyer\\Response;\n\nclass DenyAllMiddleware\n{\n    public function handle(Request $req, Response $res, callable $next)\n    {\n        return $res-&gt;setStatusCode(405)-&gt;withJson([\n            'error' =&gt; 'This resource is read-only.'\n        ]);\n    }\n}\n</code></pre>"},{"location":"advanced/cookbook/#2-configuration","title":"2. Configuration","text":"<p>Use the <code>write</code> key to apply this middleware only to <code>POST</code>, <code>PATCH</code>, and <code>DELETE</code>.</p> <pre><code>use App\\Middlewares\\DenyAllMiddleware;\n\nRubikREST::configure($app)\n    -&gt;resource('archive/logs', SystemLog::class, [\n        'read'  =&gt; [],                 // Public access\n        'write' =&gt; [DenyAllMiddleware::class] // Block modifications\n    ]);\n</code></pre>"},{"location":"advanced/cookbook/#custom-validation-logic","title":"Custom Validation Logic","text":"<p>While RubikREST handles basic data types, business logic validation should happen inside your Model. You can throw exceptions with specific HTTP codes to control the response.</p> <pre><code>// App/Models/User.php\n\npublic function beforeSave(): bool\n{\n    // Example: Validate password strength\n    if (strlen($this-&gt;password) &lt; 8) {\n        throw new \\Exception(\"Password must be at least 8 characters long.\", 400);\n    }\n\n    // Example: Prevent changing email after creation\n    if (isset($this-&gt;_dirty['email'])) {\n        throw new \\Exception(\"Email address cannot be changed.\", 409);\n    }\n\n    return true;\n}\n</code></pre>"},{"location":"advanced/cookbook/#restricting-field-access-hidden-fields","title":"Restricting Field Access (Hidden Fields)","text":"<p>To prevent sensitive data (like <code>password</code> or <code>api_token</code>) from being sent in the API response, override the <code>toArray</code> method in your Rubik Model.</p> <pre><code>// App/Models/User.php\n\npublic function toArray(): array\n{\n    $data = parent::toArray();\n\n    // Remove sensitive fields\n    unset($data['password']);\n    unset($data['secret_token']);\n\n    return $data;\n}\n</code></pre>"},{"location":"client-libraries/js-client/","title":"JavaScript Client","text":"<p>RubikREST provides a lightweight, dependency-free JavaScript client class (<code>RubikClient</code>) designed to simplify interacting with your API. It features a fluent query builder, automatic JSON parsing, and error handling.</p>"},{"location":"client-libraries/js-client/#installation","title":"Installation","text":"<p>There are three ways to include the client in your project.</p>"},{"location":"client-libraries/js-client/#1-direct-import-es-modules","title":"1. Direct Import (ES Modules)","text":"<p>Move <code>RubikREST.js</code> or <code>RubikREST.min.js</code> from <code>vendor/adaiasmagdiel/rubik-rest/js/</code> to your project folder.</p> <pre><code>import { RubikClient } from \"./js/RubikREST.js\";\n\nconst api = new RubikClient(\"http://localhost:8000/api\");\n</code></pre>"},{"location":"client-libraries/js-client/#2-import-via-cdn-github-raw","title":"2. Import via CDN (GitHub Raw)","text":"<p>You can import the minified version directly from the repository.</p> <p>Production Use</p> <p>For high-traffic production environments, consider hosting the file yourself or using a dedicated CDN service (like jsDelivr) pointing to a specific release tag to avoid breaking changes or rate limits.</p> <pre><code>import { RubikClient } from \"https://github.com/AdaiasMagdiel/rubik-rest/raw/refs/heads/main/js/RubikREST.min.js\";\n\nconst api = new RubikClient(\"https://mysite.com/api\");\n</code></pre>"},{"location":"client-libraries/js-client/#3-classic-script-tag","title":"3. Classic Script Tag","text":"<p>If you are not using ES Modules, you can include the script in your HTML. The class will be available globally as <code>window.RubikClient</code>.</p> <pre><code>&lt;script src=\"path/to/RubikREST.min.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n  const api = new RubikClient(\"https://mysite.com/api\");\n&lt;/script&gt;\n</code></pre>"},{"location":"client-libraries/js-client/#usage-reference","title":"Usage Reference","text":""},{"location":"client-libraries/js-client/#initialization","title":"Initialization","text":"<pre><code>const api = new RubikClient(baseUrl, headers);\n</code></pre> Parameter Type Description <code>baseUrl</code> <code>string</code> The root URL of your API (e.g., <code>https://api.example.com</code>). <code>headers</code> <code>object</code> Optional global headers (e.g., <code>{ 'Authorization': 'Bearer ...' }</code>)."},{"location":"client-libraries/js-client/#resource-selection","title":"Resource Selection","text":"<p>Start a query chain by selecting a resource.</p> <pre><code>const query = api.from(\"users\"); // Points to /users\n</code></pre>"},{"location":"client-libraries/js-client/#query-builder-methods-get","title":"Query Builder Methods (GET)","text":"<p>These methods allow you to construct the URL parameters for filtering, sorting, and pagination.</p> Method Arguments Description <code>.select(cols)</code> <code>string[]</code> or <code>string</code> Columns to return. Ex: <code>.select(['id', 'name'])</code>. <code>.with(relations)</code> <code>string[]</code> or <code>string</code> Eager load relationships. Ex: <code>.with('posts')</code>. <code>.orderBy(col, dir)</code> <code>string</code>, <code>asc\\|desc</code> Sort results. Default <code>asc</code>. <code>.page(page, size)</code> <code>int</code>, <code>int</code> Helper for pagination. Sets limit and offset automatically. <code>.limit(n)</code> <code>int</code> Max records to return. <code>.offset(n)</code> <code>int</code> Records to skip. <code>.withCount()</code> none Asks the API to return the total record count in the metadata."},{"location":"client-libraries/js-client/#filter-shortcuts","title":"Filter Shortcuts","text":"<p>All filters correspond to the URL syntax <code>column.operator=value</code>.</p> Method Example SQL Equivalent <code>.where(col, op, val)</code> <code>.where('age', 'gt', 18)</code> Generic filter method. <code>.eq(col, val)</code> <code>.eq('status', 'active')</code> <code>=</code> <code>.neq(col, val)</code> <code>.neq('status', 'banned')</code> <code>&lt;&gt;</code> <code>.gt(col, val)</code> <code>.gt('price', 100)</code> <code>&gt;</code> <code>.gte(col, val)</code> <code>.gte('price', 100)</code> <code>&gt;=</code> <code>.lt(col, val)</code> <code>.lt('qty', 10)</code> <code>&lt;</code> <code>.lte(col, val)</code> <code>.lte('qty', 10)</code> <code>&lt;=</code> <code>.like(col, val)</code> <code>.like('name', 'Jo*')</code> <code>LIKE</code> (use <code>*</code> for wildcard). <code>.ilike(col, val)</code> <code>.ilike('name', 'jo*')</code> <code>ILIKE</code> (Case insensitive). <code>.in(col, array)</code> <code>.in('id', [1, 2, 3])</code> <code>IN (...)</code> <code>.is(col, val)</code> <code>.is('deleted_at', 'null')</code> <code>IS NULL</code> / <code>IS TRUE</code>"},{"location":"client-libraries/js-client/#execution-methods","title":"Execution Methods","text":"<p>These methods trigger the actual HTTP request.</p>"},{"location":"client-libraries/js-client/#get","title":"<code>get()</code>","text":"<p>Executes a GET request with the built query parameters.</p> <pre><code>const res = await api.from('users').where('active', 'is', 'true').get();\n\n// Response Structure\n{\n    data: [...],   // Array of records\n    count: 150,    // Total count (if .withCount() was used)\n    error: null,   // Error object if failed\n    status: 200    // HTTP Status code\n}\n</code></pre>"},{"location":"client-libraries/js-client/#findid","title":"<code>find(id)</code>","text":"<p>Executes a GET request for a specific ID.</p> <pre><code>const res = await api.from(\"users\").find(42);\n</code></pre>"},{"location":"client-libraries/js-client/#createdata","title":"<code>create(data)</code>","text":"<p>Executes a POST request to create a record.</p> <pre><code>const res = await api.from(\"users\").create({\n  name: \"John Doe\",\n  email: \"john@example.com\",\n});\n</code></pre>"},{"location":"client-libraries/js-client/#updateid-data","title":"<code>update(id, data)</code>","text":"<p>Executes a PATCH request to update a record.</p> <pre><code>const res = await api.from(\"users\").update(42, {\n  name: \"John Updated\",\n});\n</code></pre>"},{"location":"client-libraries/js-client/#deleteid","title":"<code>delete(id)</code>","text":"<p>Executes a DELETE request.</p> <pre><code>const res = await api.from(\"users\").delete(42);\n</code></pre>"},{"location":"client-libraries/js-client/#debugging-and-source-maps","title":"Debugging and Source Maps","text":"<p>The library comes with <code>RubikREST.min.js.map</code>. This file maps the minified code back to the original source.</p> <p>If you are using the minified version in development, ensure the <code>.map</code> file is in the same directory as the <code>.min.js</code> file. Modern browsers (Chrome DevTools, Firefox Developer Tools) will automatically detect it and allow you to debug the code as if you were using the original uncompressed file.</p>"},{"location":"core-concepts/api-features/","title":"API Features","text":"<p><code>RubikREST</code> provides a powerful URL-based query language. All registered resources inherit these features automatically.</p>"},{"location":"core-concepts/api-features/#field-selection","title":"Field Selection","text":"<p>Return only the required data to save bandwidth.</p> <p><code>GET /api/users?select=id,name,email</code></p>"},{"location":"core-concepts/api-features/#pagination","title":"Pagination","text":"<p>Control how many records are returned.</p> <ul> <li><code>limit</code>: Number of records.</li> <li><code>offset</code>: Number of records to skip.</li> </ul> <p><code>GET /api/users?limit=10&amp;offset=20</code></p>"},{"location":"core-concepts/api-features/#sorting","title":"Sorting","text":"<p>Sort by one or more columns. Use the <code>column.direction</code> format.</p> <p><code>GET /api/products?order=price.desc,name.asc</code></p>"},{"location":"core-concepts/api-features/#eager-loading-relationships","title":"Eager Loading (Relationships)","text":"<p>Automatically load Rubik relationships in the response.</p> <p><code>GET /api/users?with=posts,profile</code></p>"},{"location":"core-concepts/api-features/#filters-where","title":"Filters (Where)","text":"<p>You can filter any column using the <code>column.operator=value</code> syntax. If the operator is omitted, equality (<code>eq</code>) is assumed.</p>"},{"location":"core-concepts/api-features/#available-operators","title":"Available Operators","text":"Operator URL Example SQL Equivalent Equality <code>status=active</code> or <code>status.eq=active</code> <code>WHERE status = 'active'</code> Not equal <code>status.neq=banned</code> <code>WHERE status &lt;&gt; 'banned'</code> Greater than <code>age.gt=18</code> <code>WHERE age &gt; 18</code> Greater than or equal <code>age.gte=18</code> <code>WHERE age &gt;= 18</code> Less than <code>price.lt=100</code> <code>WHERE price &lt; 100</code> Less than or equal <code>price.lte=100</code> <code>WHERE price &lt;= 100</code> Like (Search) <code>name.like=Jo*</code> (use <code>*</code> as wildcard) <code>WHERE name LIKE 'Jo%'</code> ILike (Case insensitive) <code>name.ilike=jo*</code> <code>WHERE name ILIKE 'jo%'</code> IN (List) <code>id.in=1,2,3</code> <code>WHERE id IN (1, 2, 3)</code> IS (Boolean/Null) <code>deleted_at.is=null</code> <code>WHERE deleted_at IS NULL</code> <p>Wildcard Tip</p> <p>In <code>like</code> and <code>ilike</code> filters, use the asterisk <code>*</code> in the URL to represent SQL\u2019s <code>%</code>. The system performs the substitution automatically.</p>"},{"location":"core-concepts/api-features/#total-count","title":"Total Count","text":"<p>To retrieve the total number of records (useful for frontend pagination), add <code>count</code> to the query. The result will be returned in the <code>count</code> key of the JSON response.</p> <p><code>GET /api/users?limit=5&amp;count</code></p>"},{"location":"core-concepts/api-features/#custom-error-responses","title":"Custom Error Responses","text":"<p>You can control the HTTP status code returned by the API simply by throwing exceptions with the desired code in your Rubik Models hooks (e.g., <code>beforeSave</code>, <code>beforeDelete</code>).</p> <p>Example: preventing deletion of a specific record</p> <pre><code>// In your User Model\npublic function beforeDelete(): bool\n{\n    if ($this-&gt;id === 1) {\n        // This will result in a 403 Forbidden response\n        throw new \\Exception(\"Cannot delete the root admin.\", 403);\n    }\n    return true;\n}\n</code></pre>"},{"location":"core-concepts/security/","title":"Security","text":""},{"location":"core-concepts/security/#protection-against-mass-assignment","title":"Protection Against Mass Assignment","text":"<p>RubikREST automatically checks the <code>$fillable</code> property on your Rubik Models before persisting data to the database (Create and Update operations).</p> <p>If <code>$fillable</code> is defined, only the listed fields will be saved. Any other fields sent in the JSON payload will be silently ignored.</p> <pre><code>// In your Model\npublic static array $fillable = ['name', 'bio'];\n\n// Malicious payload sent: {\"name\": \"X\", \"is_admin\": true}\n// Result: Only \"name\" is saved. \"is_admin\" is discarded.\n</code></pre> <p>Permissive Mode</p> <p>If <code>$fillable</code> is not defined on the Model, RubikREST will accept all submitted fields. It is highly recommended to define <code>$fillable</code> in production.</p>"},{"location":"core-concepts/security/#middlewares","title":"Middlewares","text":"<p>You can apply middlewares (authentication, logging, rate limiting) to specific resources during registration.</p>"},{"location":"core-concepts/security/#basic-usage","title":"Basic Usage","text":"<p>Pass a simple array of middleware classes to apply them to all routes of that resource.</p> <pre><code>use App\\Middlewares\\AuthMiddleware;\n\nRubikREST::configure($app)\n    -&gt;resource('admin/logs', Log::class, [AuthMiddleware::class]);\n</code></pre>"},{"location":"core-concepts/security/#granular-control-read-vs-write","title":"Granular Control (Read vs Write)","text":"<p>You often want public access for reading data but authentication for modifying it. RubikREST allows you to define middlewares for specific action groups using an associative array.</p> Key Targets Description <code>all</code> All Routes Applied to everything. <code>read</code> <code>index</code>, <code>show</code> Applied to GET requests. <code>write</code> <code>store</code>, <code>update</code>, <code>destroy</code> Applied to POST, PATCH, DELETE. <code>index</code> List Specific to the listing route. <code>show</code> Detail Specific to the single item route. <code>store</code> Create Specific to creation. <code>update</code> Update Specific to update (single and batch). <code>destroy</code> Delete Specific to deletion (single and batch)."},{"location":"core-concepts/security/#example-public-read-private-write","title":"Example: Public Read, Private Write","text":"<pre><code>RubikREST::configure($app)\n    -&gt;resource('products', Product::class, [\n        // Everyone can see products\n        'read' =&gt; [],\n        // Only authenticated users can create/edit/delete\n        'write' =&gt; [AuthMiddleware::class]\n    ]);\n</code></pre>"},{"location":"core-concepts/security/#example-admin-only-delete","title":"Example: Admin-only Delete","text":"<pre><code>RubikREST::configure($app)\n    -&gt;resource('users', User::class, [\n        // All actions require login\n        'all' =&gt; [AuthMiddleware::class],\n        // Only admins can delete\n        'destroy' =&gt; [AdminMiddleware::class]\n    ]);\n</code></pre>"},{"location":"core-concepts/security/#error-handling","title":"Error Handling","text":"<p>The controller catches exceptions and returns semantic HTTP status codes:</p> <ul> <li>400 Bad Request: Invalid JSON or a non-existent column requested.</li> <li>404 Not Found: Record not found.</li> <li>409 Conflict: Integrity violation (e.g., duplicate unique key).</li> <li>500 Internal Server Error: General errors (details hidden if <code>APP_DEBUG</code> is false).</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>RubikREST is distributed via Composer.</p>"},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>PHP 8.0 or higher</li> <li><code>adaiasmagdiel/erlenmeyer</code> ^5.0</li> <li><code>adaiasmagdiel/rubik</code> ^6.0</li> </ul>"},{"location":"getting-started/installation/#installing-via-composer","title":"Installing via Composer","text":"<p>Run the following command in your project\u2019s root directory:</p> <pre><code>composer require adaiasmagdiel/rubik-rest\n</code></pre>"},{"location":"getting-started/quickstart/","title":"Basic Configuration","text":"<p>See how to configure your REST API in minutes.</p>"},{"location":"getting-started/quickstart/#1-configuring-the-application","title":"1. Configuring the Application","text":"<p>In your application entry file (where you instantiate the Erlenmeyer <code>App</code>), configure RubikREST.</p> <pre><code>&lt;?php\nrequire 'vendor/autoload.php';\n\nuse AdaiasMagdiel\\Erlenmeyer\\App;\nuse AdaiasMagdiel\\RubikREST\\RubikREST;\nuse App\\Models\\User;\nuse App\\Models\\Product;\n\n$app = new App();\n\n// 1. Start configuration (default prefix: /api)\nRubikREST::configure($app, '/api')\n\n    // 2. Register resources\n    -&gt;resource('users', User::class)\n    -&gt;resource('products', Product::class)\n\n    // 3. (Optional) Enable Swagger UI at /docs\n    -&gt;enableDocs('/docs');\n\n$app-&gt;run();\n</code></pre> <p>Development with PHP Built-in Server</p> <p>If you are running the application using PHP\u2019s built-in server (<code>php -S</code>), it is recommended to explicitly define the second parameter of <code>enableDocs</code>.</p> <pre><code>This prevents the server from interpreting the JSON specification route as a non-existent static file, which would otherwise result in 404 errors when rendering the Swagger UI.\n</code></pre> <pre><code>// ...\n\nRubikREST::configure($app, '/api')\n\n    // 2. Register resources\n    -&gt;resource('users', User::class)\n    -&gt;resource('products', Product::class)\n\n    // 3. (Optional) Enable Swagger UI at /docs\n    -&gt;enableDocs('/docs', 'openapi'); // without \".json\" to prevent the server from looking for a real file\n</code></pre>"},{"location":"getting-started/quickstart/#2-creating-the-model","title":"2. Creating the Model","text":"<p>Your models must extend the Rubik <code>Model</code> class and should ideally define the <code>$fillable</code> property for security.</p> <pre><code>&lt;?php\nnamespace App\\Models;\n\nuse AdaiasMagdiel\\Rubik\\Column;\nuse AdaiasMagdiel\\Rubik\\Model;\n\nclass User extends Model\n{\n    protected static string $table = 'users';\n\n    // Defines which fields can be created/updated via the API\n    public static array $fillable = ['name', 'email', 'username'];\n\n    // Required to correctly generate the Swagger schema\n    public static function fields(): array\n    {\n        return [\n            'id'       =&gt; Column::Serial(primaryKey: true),\n            'name'     =&gt; Column::Varchar(length: 120, notNull: true),\n            'username' =&gt; Column::Varchar(length: 30, notNull: true, unique: true),\n            'email'    =&gt; Column::Varchar(length: 255, notNull: true, unique: true),\n            // ...\n        ];\n    }\n}\n</code></pre>"},{"location":"getting-started/quickstart/#3-testing","title":"3. Testing","text":"<p>You can now access:</p> <ul> <li>List users: <code>GET /api/users</code></li> <li>Create user: <code>POST /api/users</code></li> <li>View documentation: <code>GET /docs</code></li> </ul>"}]}